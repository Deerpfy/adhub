<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Steam Farm - AdHUB</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéÆ</text></svg>">
    <script>
    // Load JSZip with fallback
    (function() {
        console.log('[SteamFarm] Loading JSZip...');
        const sources = [
            'jszip.min.js',
            'https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js',
            'https://unpkg.com/jszip@3.10.1/dist/jszip.min.js'
        ];
        let currentIndex = 0;
        function tryLoadJSZip() {
            if (currentIndex >= sources.length) {
                console.error('[SteamFarm] Failed to load JSZip');
                return;
            }
            const script = document.createElement('script');
            script.src = sources[currentIndex];
            script.onerror = function() {
                currentIndex++;
                tryLoadJSZip();
            };
            script.onload = function() {
                console.log('[SteamFarm] JSZip loaded:', JSZip.version);
            };
            document.head.appendChild(script);
        }
        tryLoadJSZip();
    })();
    </script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="header-left">
                    <a href="../../index.html" class="back-btn" title="Zpƒõt na AdHUB">
                        <span class="back-icon">‚Üê</span>
                    </a>
                    <div class="logo">
                        <span class="logo-icon">üéÆ</span>
                        <span>Steam Farm</span>
                    </div>
                    <span class="version-badge">v2.0</span>
                </div>
                <div class="header-right">
                    <div class="connection-status" id="connectionStatus">
                        <span class="status-dot disconnected"></span>
                        <span class="status-text">Nep≈ôipojeno</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Security Notice -->
            <div class="security-notice" id="securityNotice">
                <div class="notice-icon">üîí</div>
                <div class="notice-content">
                    <h3>100% Lok√°ln√≠ zpracov√°n√≠</h3>
                    <p>Va≈°e p≈ôihla≈°ovac√≠ √∫daje nikdy neopou≈°tƒõj√≠ v√°≈° poƒç√≠taƒç. Ve≈°ker√° komunikace prob√≠h√° p≈ô√≠mo mezi va≈°√≠m prohl√≠≈æeƒçem a Steam servery p≈ôes lok√°ln√≠ WebSocket Service.</p>
                </div>
                <button class="notice-close" onclick="this.parentElement.style.display='none'">√ó</button>
            </div>

            <!-- Extension Check -->
            <div class="extension-check" id="extensionCheck">
                <div class="check-card warning">
                    <div class="check-icon">‚ö†Ô∏è</div>
                    <h3>Vy≈æadov√°no roz≈°√≠≈ôen√≠ a service</h3>
                    <p>Pro fungov√°n√≠ Steam Farm je pot≈ôeba nainstalovat Chrome roz≈°√≠≈ôen√≠ a Steam Farm Service. Instalace je jednoduch√° - staƒç√≠ st√°hnout a spustit instal√°tor!</p>
                    <div class="check-steps">
                        <div class="step" id="stepExtension">
                            <span class="step-status">‚óã</span>
                            <span class="step-text">Chrome/Edge roz≈°√≠≈ôen√≠</span>
                        </div>
                        <div class="step" id="stepService">
                            <span class="step-status">‚óã</span>
                            <span class="step-text">Steam Farm Service</span>
                        </div>
                    </div>
                    <a href="#installation" class="btn btn-primary">Zobrazit n√°vod k instalaci</a>
                </div>
            </div>

            <!-- Vault Section -->
            <section class="section vault-section" id="vaultSection" style="display: none;">
                <div class="section-header">
                    <h2><span class="section-icon">üîê</span> Bezpeƒçnostn√≠ trezor</h2>
                </div>
                <div class="vault-card">
                    <!-- Create Vault -->
                    <div id="vaultCreate" style="display: none;">
                        <div class="vault-info">
                            <span class="vault-icon">üõ°Ô∏è</span>
                            <h3>Vytvo≈ôte bezpeƒçnostn√≠ heslo</h3>
                            <p>Va≈°e p≈ôihla≈°ovac√≠ √∫daje ke Steam budou ≈°ifrov√°ny pomoc√≠ AES-256 s kl√≠ƒçem odvozen√Ωm z va≈°eho hesla p≈ôes Argon2id.</p>
                        </div>
                        <form id="createVaultForm" class="vault-form">
                            <div class="form-group">
                                <label for="vaultPassword">Heslo pro trezor</label>
                                <input type="password" id="vaultPassword" required minlength="4" placeholder="Minim√°lnƒõ 4 znaky">
                            </div>
                            <div class="form-group">
                                <label for="vaultPasswordConfirm">Potvrzen√≠ hesla</label>
                                <input type="password" id="vaultPasswordConfirm" required minlength="4" placeholder="Zopakujte heslo">
                            </div>
                            <p class="form-hint">‚ö†Ô∏è Pokud heslo zapomenete, m≈Ø≈æete trezor smazat a vytvo≈ôit nov√Ω, ale ztrat√≠te ulo≈æenou session.</p>
                            <button type="submit" class="btn btn-primary btn-large" id="createVaultBtn">
                                <span class="btn-icon">üîí</span>
                                Vytvo≈ôit trezor
                            </button>
                        </form>
                    </div>

                    <!-- Unlock Vault -->
                    <div id="vaultUnlock" style="display: none;">
                        <div class="vault-info">
                            <span class="vault-icon">üîì</span>
                            <h3>Odemknƒõte trezor</h3>
                            <p>Zadejte heslo pro p≈ô√≠stup k ≈°ifrovan√Ωm √∫daj≈Øm.</p>
                        </div>
                        <form id="unlockVaultForm" class="vault-form">
                            <div class="form-group">
                                <label for="unlockPassword">Heslo trezoru</label>
                                <input type="password" id="unlockPassword" required placeholder="Zadejte heslo">
                            </div>
                            <button type="submit" class="btn btn-primary btn-large" id="unlockVaultBtn">
                                <span class="btn-icon">üîì</span>
                                Odemknout
                            </button>
                        </form>
                        <div class="vault-reset">
                            <button class="btn btn-danger btn-small" id="deleteVaultBtn">
                                üóëÔ∏è Smazat trezor a zaƒç√≠t znovu
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Login Section -->
            <section class="section login-section" id="loginSection" style="display: none;">
                <div class="section-header">
                    <h2><span class="section-icon">üîê</span> P≈ôihl√°≈°en√≠ ke Steam</h2>
                </div>
                <div class="login-card">
                    <form id="loginForm" class="login-form">
                        <div class="form-group">
                            <label for="username">Steam u≈æivatelsk√© jm√©no</label>
                            <input type="text" id="username" name="username" required autocomplete="username" placeholder="V√°≈° Steam login">
                        </div>
                        <div class="form-group">
                            <label for="password">Heslo</label>
                            <input type="password" id="password" name="password" required autocomplete="current-password" placeholder="Va≈°e Steam heslo">
                        </div>
                        <div class="form-group">
                            <label for="sharedSecret">Shared Secret (voliteln√©)</label>
                            <input type="password" id="sharedSecret" name="sharedSecret" placeholder="Pro automatick√© 2FA">
                            <span class="form-hint">Pokud m√°te Mobile Authenticator, zadejte shared_secret pro automatick√© p≈ôihl√°≈°en√≠</span>
                        </div>
                        <button type="submit" class="btn btn-primary btn-large" id="loginBtn">
                            <span class="btn-icon">üöÄ</span>
                            P≈ôihl√°sit se
                        </button>
                    </form>

                    <!-- Steam Guard Dialog -->
                    <div class="steam-guard-dialog" id="steamGuardDialog" style="display: none;">
                        <h3>üîê Steam Guard</h3>
                        <p id="steamGuardText">Zadejte k√≥d ze Steam Guard</p>
                        <input type="text" id="steamGuardCode" maxlength="5" placeholder="XXXXX" autocomplete="one-time-code">
                        <button class="btn btn-primary" id="submitGuardCode">Potvrdit</button>
                    </div>
                </div>
            </section>

            <!-- Account Info -->
            <section class="section account-section" id="accountSection" style="display: none;">
                <div class="section-header">
                    <h2><span class="section-icon">üë§</span> <span id="accountName">-</span></h2>
                    <button class="btn btn-secondary btn-small" id="logoutBtn">Odhl√°sit</button>
                </div>
                <div class="account-stats">
                    <div class="stat-card">
                        <span class="stat-icon">üéÆ</span>
                        <span class="stat-value" id="totalGames">0</span>
                        <span class="stat-label">Her</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-icon">üÉè</span>
                        <span class="stat-value" id="totalCards">0</span>
                        <span class="stat-label">Zb√Ωvaj√≠c√≠ch kartiƒçek</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-icon">‚è±Ô∏è</span>
                        <span class="stat-value" id="totalHours">0</span>
                        <span class="stat-label">Hodin celkem</span>
                    </div>
                    <div class="stat-card active">
                        <span class="stat-icon">‚ñ∂Ô∏è</span>
                        <span class="stat-value" id="farmingCount">0</span>
                        <span class="stat-label">Aktivnƒõ farm√≠</span>
                    </div>
                </div>
            </section>

            <!-- Farming Controls -->
            <section class="section farming-section" id="farmingSection" style="display: none;">
                <div class="section-header">
                    <h2><span class="section-icon">üöú</span> Farming</h2>
                    <div class="farming-controls">
                        <button class="btn btn-success" id="startAllBtn" title="Spustit farmen√≠ v≈°ech vybran√Ωch">
                            ‚ñ∂Ô∏è Spustit v≈°e
                        </button>
                        <button class="btn btn-danger" id="stopAllBtn" title="Zastavit farmen√≠">
                            ‚èπÔ∏è Zastavit
                        </button>
                    </div>
                </div>

                <!-- Filters -->
                <div class="filters">
                    <div class="filter-group">
                        <label>Filtr:</label>
                        <button class="filter-btn active" data-filter="all">V≈°e</button>
                        <button class="filter-btn" data-filter="cards">S kartiƒçkami</button>
                        <button class="filter-btn" data-filter="hours">Pro hodiny</button>
                        <button class="filter-btn" data-filter="selected">Vybran√©</button>
                    </div>
                    <div class="search-group">
                        <input type="text" id="gameSearch" placeholder="Hledat hru..." class="search-input">
                    </div>
                </div>

                <!-- Games Grid -->
                <div class="games-grid" id="gamesGrid">
                    <!-- Games will be rendered here -->
                    <div class="empty-state" id="emptyGames">
                        <span class="empty-icon">üéÆ</span>
                        <p>Naƒç√≠t√°n√≠ her...</p>
                    </div>
                </div>
            </section>

            <!-- Currently Farming -->
            <section class="section current-farming-section" id="currentFarmingSection" style="display: none;">
                <div class="section-header">
                    <h2><span class="section-icon">‚ö°</span> Pr√°vƒõ farm√≠m</h2>
                    <span class="farming-info" id="farmingInfo">0/32 slot≈Ø</span>
                </div>
                <div class="farming-list" id="farmingList">
                    <!-- Currently farming games will be shown here -->
                </div>
            </section>

            <!-- Installation Guide -->
            <section class="section installation-section" id="installation">
                <div class="section-header">
                    <h2><span class="section-icon">üì¶</span> Instalace</h2>
                </div>

                <div class="install-options">
                    <!-- Krok 1: Sta≈æen√≠ pluginu -->
                    <div class="install-card install-card-primary">
                        <div class="install-card-header">
                            <span class="install-badge">Krok 1</span>
                            <h3>St√°hni plugin</h3>
                        </div>
                        <p>St√°hni Chrome roz≈°√≠≈ôen√≠ jako ZIP soubor p≈ô√≠mo z GitHub repozit√°≈ôe.</p>

                        <!-- Commit info -->
                        <div class="commit-info" id="commitInfo">
                            <div class="commit-loading" id="commitLoading">
                                <div class="spinner-small"></div>
                                <span>Naƒç√≠t√°m informace o verzi...</span>
                            </div>
                            <div class="commit-details" id="commitDetails" style="display: none;">
                                <div class="commit-row">
                                    <span class="commit-label">Posledn√≠ commit:</span>
                                    <code id="latestCommitId" class="commit-id">-</code>
                                </div>
                                <div class="commit-row">
                                    <span class="commit-label">Datum:</span>
                                    <span id="latestCommitDate">-</span>
                                </div>
                                <div class="commit-row">
                                    <span class="commit-label">Zpr√°va:</span>
                                    <span id="latestCommitMessage" class="commit-message">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="install-actions">
                            <button class="btn btn-primary btn-large" id="downloadPluginBtn">
                                <span class="btn-icon">üì•</span>
                                St√°hnout plugin (.zip)
                            </button>
                        </div>

                        <div class="download-progress" id="downloadProgress" style="display: none;">
                            <div class="progress-bar">
                                <div class="progress-fill" id="downloadProgressFill"></div>
                            </div>
                            <span id="downloadProgressText">Generuji ZIP...</span>
                        </div>
                    </div>

                    <!-- GitHub odkaz -->
                    <div class="install-card">
                        <h3>Alternativa: GitHub</h3>
                        <p>M≈Ø≈æete tak√© st√°hnout plugin p≈ô√≠mo z GitHubu.</p>
                        <a href="https://github.com/Deerpfy/adhub/tree/main/projects/steam-farm/plugin"
                           target="_blank" class="btn btn-secondary">
                            Otev≈ô√≠t na GitHubu
                        </a>
                    </div>
                </div>

                <!-- Krok 2: Instalace roz≈°√≠≈ôen√≠ -->
                <div class="installation-steps">
                    <div class="install-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h3>Nainstaluj roz≈°√≠≈ôen√≠ do prohl√≠≈æeƒçe</h3>
                            <ol>
                                <li>Rozbal sta≈æen√Ω ZIP soubor</li>
                                <li>Otev≈ôi <code>chrome://extensions</code> v prohl√≠≈æeƒçi</li>
                                <li>Zapni "Re≈æim pro v√Ωvoj√°≈ôe" (vpravo naho≈ôe)</li>
                                <li>Klikni "Naƒç√≠st rozbalen√© roz≈°√≠≈ôen√≠"</li>
                                <li>Vyber rozbalenu slo≈æku pluginu</li>
                            </ol>
                        </div>
                    </div>

                    <!-- Krok 3: Steam Farm Service -->
                    <div class="install-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h3>Spus≈• Steam Farm Service</h3>
                            <p class="step-desc">Service bƒõ≈æ√≠ na pozad√≠ a komunikuje se Steam servery. Otev≈ôi termin√°l a spus≈•:</p>
                            <div class="os-tabs">
                                <button class="os-tab active" data-os="windows">Windows</button>
                                <button class="os-tab" data-os="linux">Linux/macOS</button>
                            </div>
                            <div class="os-content" id="os-windows">
                                <pre><code>cd projects/steam-farm/native-host
npm install
node steam-farm-service.js</code></pre>
                            </div>
                            <div class="os-content" id="os-linux" style="display: none;">
                                <pre><code>cd projects/steam-farm/native-host
npm install
node steam-farm-service.js</code></pre>
                            </div>
                            <p class="install-note">Service mus√≠ bƒõ≈æet na pozad√≠, aby mohl plugin komunikovat se Steam servery.</p>
                        </div>
                    </div>

                    <!-- Krok 4 -->
                    <div class="install-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h3>Obnov str√°nku</h3>
                            <p>Po instalaci obnov tuto str√°nku (F5). Roz≈°√≠≈ôen√≠ se automaticky p≈ôipoj√≠ ke slu≈æbƒõ a m≈Ø≈æe≈° zaƒç√≠t farmit!</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Cards Section -->
            <section class="section cards-section" id="cardsSection" style="display: none;">
                <div class="section-header">
                    <h2><span class="section-icon">üÉè</span> Trading Cards</h2>
                    <button class="btn btn-secondary btn-small" id="refreshCardsBtn">üîÑ Obnovit</button>
                </div>
                <div class="cards-info">
                    <p>Zobrazen√≠ zb√Ωvaj√≠c√≠ch kartiƒçek pro va≈°e hry. Kartiƒçky padaj√≠ pouze u her s kartiƒçkami, kter√© m√°te ve vlastnictv√≠.</p>
                </div>
                <div class="cards-grid" id="cardsGrid">
                    <!-- Cards info will be rendered here -->
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <span class="footer-text">Steam Farm - AdHUB Project</span>
                <span class="footer-version">v2.0.0</span>
            </div>
        </footer>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="script.js"></script>
</body>
</html>
