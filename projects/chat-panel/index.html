<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AdHub Multistream Chat v2</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <h1 class="app-title">
                    <span class="logo-icon">üí¨</span>
                    Multistream Chat
                    <span class="version-badge">v2</span>
                </h1>
            </div>
            <div class="header-center">
                <div class="connection-status" id="connectionStatus">
                    <span class="status-dot"></span>
                    <span class="status-text">Nep≈ôipojeno</span>
                </div>
            </div>
            <div class="header-right">
                <button class="btn btn-icon btn-extension" id="extensionBtn" title="Chrome Extension">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path>
                    </svg>
                    <span class="extension-status-dot" id="extensionStatusDot"></span>
                </button>
                <button class="btn btn-icon" id="settingsBtn" title="Nastaven√≠">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                    </svg>
                </button>
                <button class="btn btn-icon" id="themeToggle" title="P≈ôepnout t√©ma">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Sidebar - Channel List -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h2>Kan√°ly</h2>
                    <button class="btn btn-primary btn-sm" id="addChannelBtn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        P≈ôidat
                    </button>
                </div>
                <div class="channel-filter-hint">
                    <span class="hint-icon">üí°</span>
                    <span class="hint-text">Klikni na kan√°l pro zv√Ωraznƒõn√≠ jeho zpr√°v</span>
                </div>
                <div class="channel-filter-active hidden" id="channelFilterActive">
                    <span class="filter-status">
                        <span class="filter-icon">‚òÖ</span>
                        <span class="filter-count" id="filterCount">0</span> zv√Ωraznƒõno
                    </span>
                    <button class="btn btn-sm btn-clear-filter" id="clearFilterBtn">
                        Zru≈°it filtr
                    </button>
                </div>
                <div class="channel-list" id="channelList">
                    <!-- Channels will be added here dynamically -->
                    <div class="channel-empty-state">
                        <p>Zat√≠m nem√°te ≈æ√°dn√© kan√°ly.</p>
                        <p class="hint">Kliknƒõte na "P≈ôidat" pro p≈ôipojen√≠ k chatu.</p>
                    </div>
                </div>
            </aside>

            <!-- Chat Area -->
            <section class="chat-area">
                <div class="chat-container" id="chatContainer">
                    <!-- Chat messages will be rendered here -->
                    <div class="chat-welcome">
                        <div class="welcome-icon">üéÆ</div>
                        <h2>V√≠tejte v Multistream Chat v2</h2>
                        <p>P≈ôidejte kan√°ly z Twitch, Kick nebo YouTube pro zobrazen√≠ chatu.</p>
                        <div class="platform-badges">
                            <span class="platform-badge twitch">Twitch</span>
                            <span class="platform-badge kick">Kick</span>
                            <span class="platform-badge youtube">YouTube</span>
                        </div>
                        <p class="note">Tato verze funguje kompletnƒõ v prohl√≠≈æeƒçi - ≈æ√°dn√Ω server nen√≠ pot≈ôeba!</p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Add Channel Modal -->
    <div class="modal-overlay" id="addChannelModal">
        <div class="modal">
            <div class="modal-header">
                <h3>P≈ôidat kan√°l</h3>
                <button class="btn btn-icon modal-close" id="closeAddModal">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="platform-selector">
                    <button class="platform-btn twitch active" data-platform="twitch">
                        <svg class="platform-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M11.64 5.93h1.43v4.28h-1.43m3.93-4.28H17v4.28h-1.43M4.5 0L0 4.5v15h5.25V24l4.5-4.5h3.5L22.5 12V0zm15.75 11.25l-3.25 3.25h-3.5l-2.88 2.88V14.5h-4V2.25h13.63z"/>
                        </svg>
                        Twitch
                    </button>
                    <button class="platform-btn kick" data-platform="kick">
                        <svg class="platform-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M6.5 3h3v7.5L15 3h4l-6.5 9L19 21h-4l-5.5-7.5V21h-3V3z"/>
                        </svg>
                        Kick
                    </button>
                    <button class="platform-btn youtube" data-platform="youtube">
                        <svg class="platform-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                        </svg>
                        YouTube
                    </button>
                </div>

                <!-- Twitch Form -->
                <form class="platform-form" id="twitchForm">
                    <div class="form-group">
                        <label for="twitchChannel">N√°zev kan√°lu</label>
                        <input type="text" id="twitchChannel" placeholder="nap≈ô. gamezense" autocomplete="off">
                        <span class="input-hint">Zadejte jm√©no Twitch kan√°lu bez URL</span>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">P≈ôipojit k chatu</button>
                </form>

                <!-- Kick Form -->
                <form class="platform-form hidden" id="kickForm">
                    <div class="form-group">
                        <label for="kickChannel">N√°zev kan√°lu nebo chatroom ID</label>
                        <input type="text" id="kickChannel" placeholder="nap≈ô. trainwreckstv nebo xqc:668" autocomplete="off">
                        <span class="input-hint">
                            Zn√°m√© kan√°ly: xqc, trainwreckstv, adinross, stake, roshtein, nickmercs...<br>
                            Pro ostatn√≠ zadejte: <strong>n√°zev:chatroomID</strong> (nap≈ô. streamer:12345)
                        </span>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">P≈ôipojit k chatu</button>
                </form>

                <!-- YouTube Form -->
                <form class="platform-form hidden" id="youtubeForm">
                    <!-- Mode selector -->
                    <div class="youtube-mode-selector">
                        <button type="button" class="youtube-mode-btn" data-mode="extension">
                            <span class="mode-icon">üß©</span>
                            <span class="mode-name">Extension</span>
                            <span class="mode-hint">Kombinovany chat</span>
                        </button>
                        <button type="button" class="youtube-mode-btn active" data-mode="iframe">
                            <span class="mode-icon">üì∫</span>
                            <span class="mode-name">Iframe</span>
                            <span class="mode-hint">Samostatny panel</span>
                        </button>
                        <button type="button" class="youtube-mode-btn" data-mode="api">
                            <span class="mode-icon">üîå</span>
                            <span class="mode-name">API</span>
                            <span class="mode-hint">Vyzaduje klic</span>
                        </button>
                    </div>

                    <!-- Extension mode fields -->
                    <div class="youtube-mode-fields hidden" id="youtubeExtensionFields">
                        <div class="extension-status-box" id="extensionStatusBox">
                            <div class="extension-status-icon" id="extensionStatusIcon">?</div>
                            <div class="extension-status-text" id="extensionStatusText">Kontroluji extension...</div>
                        </div>
                        <div class="form-group">
                            <label for="youtubeExtChannel">Video URL nebo ID</label>
                            <input type="text" id="youtubeExtChannel" placeholder="youtube.com/watch?v=... nebo video ID" autocomplete="off">
                            <span class="input-hint">
                                Zadejte URL nebo ID ziveho streamu.<br>
                                <strong>Vyhoda:</strong> Zpravy se zobrazi spolecne s Twitch/Kick
                            </span>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block" data-mode="extension" id="youtubeExtSubmit">Pripojit k chatu</button>
                        <div class="extension-download-section" id="extensionDownloadSection">
                            <p class="extension-download-hint" id="extensionDownloadHint">Stahnout nebo aktualizovat rozsireni:</p>
                            <button type="button" class="btn btn-secondary btn-block" id="downloadExtensionBtn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
                                    <polyline points="7 10 12 15 17 10"/>
                                    <line x1="12" y1="15" x2="12" y2="3"/>
                                </svg>
                                <span id="downloadExtensionBtnText">Stahnout AdHub Chat Reader Extension</span>
                            </button>
                            <p class="extension-version-info hidden" id="extensionVersionInfo"></p>
                            <p class="extension-commit-info hidden" id="extensionCommitInfo"></p>
                        </div>
                    </div>

                    <!-- Iframe mode fields -->
                    <div class="youtube-mode-fields" id="youtubeIframeFields">
                        <div class="form-group">
                            <label for="youtubeChannel">Kanal nebo Video ID</label>
                            <input type="text" id="youtubeChannel" placeholder="napr. @MrBeast, UC..., nebo video ID" autocomplete="off">
                            <span class="input-hint">
                                Zadejte: @handle, channel ID (UC...), video ID, nebo celou URL<br>
                                <strong>Pozor:</strong> Iframe zobrazi chat v samostatnem panelu
                            </span>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block" data-mode="iframe">Zobrazit chat (iframe)</button>
                    </div>

                    <!-- API mode fields -->
                    <div class="youtube-mode-fields hidden" id="youtubeApiFields">
                        <div class="form-group">
                            <label for="youtubeVideoId">Video/Stream ID</label>
                            <input type="text" id="youtubeVideoId" placeholder="napr. dQw4w9WgXcQ" autocomplete="off">
                            <span class="input-hint">ID videa z URL: youtube.com/watch?v=<strong>ID</strong></span>
                        </div>
                        <div class="form-group">
                            <label for="youtubeApiKey">YouTube API klic</label>
                            <input type="password" id="youtubeApiKey" placeholder="AIza..." autocomplete="off">
                            <span class="input-hint">
                                <a href="https://console.cloud.google.com/apis/credentials" target="_blank" rel="noopener">Ziskat API klic</a>
                                - klic je ulozen pouze lokalne
                            </span>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block" data-mode="api">Pripojit k chatu (API)</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <div class="modal-header">
                <h3>Nastaven√≠</h3>
                <button class="btn btn-icon modal-close" id="closeSettingsModal">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h4>Zobrazen√≠</h4>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="showTimestamps" checked>
                            Zobrazit ƒçasov√© znaƒçky
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="showPlatformBadges" checked>
                            Zobrazit badge platformy
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="showEmotes" checked>
                            Zobrazit emotes
                        </label>
                    </div>
                    <div class="setting-item">
                        <label>
                            <input type="checkbox" id="compactMode">
                            Kompaktn√≠ re≈æim
                        </label>
                    </div>
                </div>
                <div class="settings-section">
                    <h4>Chat</h4>
                    <div class="setting-item">
                        <label for="maxMessages">Max. poƒçet zpr√°v</label>
                        <input type="number" id="maxMessages" value="500" min="100" max="2000">
                    </div>
                    <div class="setting-item">
                        <label for="fontSize">Velikost p√≠sma</label>
                        <select id="fontSize">
                            <option value="12">Mal√© (12px)</option>
                            <option value="14" selected>St≈ôedn√≠ (14px)</option>
                            <option value="16">Velk√© (16px)</option>
                            <option value="18">Extra velk√© (18px)</option>
                        </select>
                    </div>
                </div>
                <div class="settings-section">
                    <h4>Data</h4>
                    <button class="btn btn-secondary" id="exportSettings">Exportovat nastaven√≠</button>
                    <button class="btn btn-secondary" id="importSettings">Importovat nastaven√≠</button>
                    <button class="btn btn-danger" id="clearAllData">Vymazat v≈°echna data</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Extension Modal -->
    <div class="modal-overlay" id="extensionModal">
        <div class="modal">
            <div class="modal-header">
                <h3>üß© Chrome Extension</h3>
                <button class="btn btn-icon modal-close" id="closeExtensionModal">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="extension-modal-status" id="extensionModalStatus">
                    <div class="extension-status-icon-large" id="extensionModalIcon">?</div>
                    <div class="extension-status-info">
                        <div class="extension-status-title" id="extensionModalTitle">Kontroluji extension...</div>
                        <div class="extension-status-version" id="extensionModalVersion"></div>
                    </div>
                </div>

                <div class="extension-version-details" id="extensionVersionDetails">
                    <div class="version-row">
                        <span class="version-label">Aktivn√≠:</span>
                        <span class="version-value" id="extensionActiveStatus">-</span>
                    </div>
                    <div class="version-row">
                        <span class="version-label">Naƒçten√° verze:</span>
                        <span class="version-value" id="extensionLoadedCommit">-</span>
                    </div>
                    <div class="version-row">
                        <span class="version-label">Dostupn√° verze:</span>
                        <span class="version-value" id="extensionGithubCommit">naƒç√≠t√°m...</span>
                    </div>
                    <div class="version-row update-status" id="extensionUpdateRow" style="display: none;">
                        <span class="version-label"></span>
                        <span class="version-value update-available" id="extensionUpdateStatus">‚¨Ü K dispozici aktualizace</span>
                    </div>
                </div>

                <div class="extension-features">
                    <h4>Funkce roz≈°√≠≈ôen√≠</h4>
                    <div class="extension-feature">
                        <span class="feature-icon youtube">‚ñ∂</span>
                        <div class="feature-info">
                            <strong>YouTube Chat Reader</strong>
                            <p>ƒåte zpr√°vy z YouTube live chatu a zobrazuje je spoleƒçnƒõ s Twitch/Kick</p>
                        </div>
                    </div>
                    <div class="extension-feature">
                        <span class="feature-icon twitch">‚öî</span>
                        <div class="feature-info">
                            <strong>Twitch Moderator</strong>
                            <p>Odes√≠l√° moderaƒçn√≠ p≈ô√≠kazy (/ban, /timeout, /delete) p≈ôes popup okna</p>
                        </div>
                    </div>
                </div>

                <div class="extension-note">
                    <strong>Bez p≈ôihla≈°ov√°n√≠!</strong> Roz≈°√≠≈ôen√≠ vyu≈æ√≠v√° va≈°i existuj√≠c√≠ session na YouTube a Twitch.
                </div>

                <div class="extension-actions">
                    <button class="btn btn-primary btn-block" id="extensionModalDownloadBtn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
                            <polyline points="7 10 12 15 17 10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        <span id="extensionModalDownloadText">St√°hnout roz≈°√≠≈ôen√≠</span>
                    </button>
                    <a href="moderator.html" class="btn btn-secondary btn-block" target="_blank">
                        V√≠ce informac√≠
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Scripts -->
    <script src="adapters/base-adapter.js"></script>
    <script src="adapters/twitch-adapter.js"></script>
    <script src="adapters/kick-adapter.js"></script>
    <script src="adapters/youtube-adapter.js"></script>
    <script src="adapters/youtube-iframe-adapter.js"></script>
    <script src="adapters/youtube-extension-adapter.js"></script>
    <script src="jszip.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
